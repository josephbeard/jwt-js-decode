!function(t,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports,require("pako"),require("crypto")):"function"==typeof define&&define.amd?define(["exports","pako","crypto"],r):r(t.jwtJsDecode={},null,null)}(this,function(t,r,e){"use strict";function n(t,r,e,n){return new(e||(e=Promise))(function(i,o){function u(t){try{s(n.next(t))}catch(t){o(t)}}function a(t){try{s(n.throw(t))}catch(t){o(t)}}function s(t){t.done?i(t.value):new e(function(r){r(t.value)}).then(u,a)}s((n=n.apply(t,r||[])).next())})}function i(t,r){function e(t){return function(r){return n([t,r])}}function n(e){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,o&&(u=2&e[0]?o.return:e[0]?o.throw||((u=o.return)&&u.call(o),0):o.next)&&!(u=u.call(o,e[1])).done)return u;switch(o=0,u&&(e=[2&e[0],u.value]),e[0]){case 0:case 1:u=e;break;case 4:return s.label++,{value:e[1],done:!1};case 5:s.label++,o=e[1],e=[0];continue;case 7:e=s.ops.pop(),s.trys.pop();continue;default:if(u=s.trys,!(u=u.length>0&&u[u.length-1])&&(6===e[0]||2===e[0])){s=0;continue}if(3===e[0]&&(!u||e[1]>u[0]&&e[1]<u[3])){s.label=e[1];break}if(6===e[0]&&s.label<u[1]){s.label=u[1],u=e;break}if(u&&s.label<u[2]){s.label=u[2],s.ops.push(e);break}u[2]&&s.ops.pop(),s.trys.pop();continue}e=r.call(t,s)}catch(t){e=[6,t],o=0}finally{i=u=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}var i,o,u,a,s={label:0,sent:function(){if(1&u[0])throw u[1];return u[1]},trys:[],ops:[]};return a={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a}function o(t){try{return JSON.parse(t)}catch(t){throw new Error(x)}}function u(t){try{if("object"==typeof window&&"function"==typeof window.atob)return window.atob(t);if("undefined"!=typeof Buffer)return Buffer.from(t,"base64").toString("binary");throw new Error(x)}catch(t){throw new Error(t)}}function a(t){if("string"!=typeof t||t.length%4!=0)throw new Error(x);return t.replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function s(t){if("string"!=typeof t||t.length%4==1)throw new Error(x);for(;t.length%4!=0;)t+="=";return t.replace(/\-/g,"+").replace(/_/g,"/")}function c(t){return u(s(t))}function f(t){return"object"==typeof t&&"string"==typeof t.zip&&"GZIP"===t.zip.toUpperCase()}function l(t){return new G(t)}function h(t){return new L(t)}function p(t){try{if("object"==typeof window&&"function"==typeof window.atob)return window.btoa(t);if("undefined"!=typeof Buffer)return Buffer.from(t).toString("base64");throw new Error(x)}catch(t){throw new Error(t)}}function w(t){return a(p(t))}function d(t){return w(b(t))}function y(t){if("string"!=typeof t)throw new Error(x);return r.inflate(t,{raw:!1,from:"string",to:"string"})}function g(t){return y(c(t))}function b(t){if("string"!=typeof t)throw new Error(x);return r.deflate(t,{raw:!1,from:"string",to:"string"})}function v(t){for(var r=new Uint8Array(t.length),e=0;e<t.length;e++)r[e]=t.charCodeAt(e);return r}function E(t){return t instanceof ArrayBuffer&&(t=new Uint8Array(t)),String.fromCharCode.apply(String,t)}function S(t,r){return n(this,void 0,void 0,function(){var o;return i(this,function(u){switch(u.label){case 0:return O?(o=v(r),[4,O.importKey("raw",o,{name:"HMAC",hash:{name:t}},!0,["sign"]).then(function(t){return{_key:t,update:function(r){return n(this,void 0,void 0,function(){return i(this,function(e){switch(e.label){case 0:return[4,O.sign("HMAC",t,v(r))];case 1:return[2,e.sent()]}})})}}})]):[3,2];case 1:return[2,u.sent()];case 2:return[2,e&&e.createHmac?Promise.resolve(e.createHmac(t.replace("SHA-","sha"),r)):Promise.reject(R)]}})})}function m(t){return function(r,e){return n(this,void 0,void 0,function(){var n,o,u,s,c,f,l;return i(this,function(i){switch(i.label){case 0:return[4,S("SHA-"+t,e)];case 1:return n=i.sent(),u=(o=Promise).resolve,O?(c=w,f=E,l=n,l?[4,n.update(r)]:[3,3]):[3,4];case 2:l=i.sent(),i.label=3;case 3:return s=c.apply(void 0,[f.apply(void 0,[l])]),[3,5];case 4:s=a(n&&n.update(r).digest("base64")),i.label=5;case 5:return[2,u.apply(o,[s])]}})})}}function A(t){return function(r,e,o){return n(this,void 0,void 0,function(){return i(this,function(n){switch(n.label){case 0:return[4,m(t)(r,o)];case 1:return[2,n.sent()===e]}})})}}function C(t){if("string"!=typeof t)throw new Error(x);var r=["-BEGIN RSA PRIVATE KEY-","-BEGIN RSA PUBLIC KEY-","-BEGIN PUBLIC KEY-","-END PUBLIC KEY-","-END RSA PRIVATE KEY-","-END RSA PUBLIC KEY-"],e=t.split("\n").map(function(t){return t.trim()}).filter(function(t){return t.length&&!r.some(function(r){return t.toUpperCase().indexOf(r)>-1})}).join("");if(e.length)return v(e);throw new Error(x)}function N(t,r,e,o){return n(this,void 0,void 0,function(){var n,u,a,s;return i(this,function(i){switch(i.label){case 0:if("string"!=typeof t||t.length<4)throw new Error(U);if("none"===(n=t.toLowerCase()))return[2,""===e];if(u=n.slice(0,2),a=parseInt(n.slice(2)),isNaN(a)||[256,384,512].indexOf(a)<0)throw new Error(U);switch(s=u){case"hs":return[3,1]}return[3,3];case 1:return[4,A(a)(r,e,o)];case 2:return[2,i.sent()];case 3:throw new Error(U)}})})}function P(t,r,e){return n(this,void 0,void 0,function(){var n,o,u,a;return i(this,function(i){switch(i.label){case 0:if("string"!=typeof t||t.length<4)throw new Error(U);if("none"===(n=t.toLowerCase()))return[2,""];if(o=n.slice(0,2),u=parseInt(n.slice(2)),isNaN(u)||[256,384,512].indexOf(u)<0)throw new Error(U);switch(a=o){case"hs":return[3,1]}return[3,3];case 1:return[4,m(u)(r,e)];case 2:return[2,i.sent()];case 3:throw new Error(U)}})})}function I(t,r){return n(this,void 0,void 0,function(){var e,n,u;return i(this,function(i){switch(i.label){case 0:return e=h(t),n=o(c(e.header)),u=e.header+"."+e.payload,[4,N(n.alg,u,e.signature,r)];case 1:return[2,i.sent()]}})})}function j(t,r){return n(this,void 0,void 0,function(){var e,n,u;return i(this,function(i){switch(i.label){case 0:return e=h(t),n=o(c(e.header)),u=e.header+"."+e.payload,[4,P(n.alg,u,r)];case 1:return[2,i.sent()]}})})}function B(t,r,e){return n(this,void 0,void 0,function(){var n,o;return i(this,function(i){switch(i.label){case 0:return n=l(t),e&&(n.header.alg=e),o=n,[4,j(n.toString(),r)];case 1:return o.signature=i.sent(),[2,n.toString()]}})})}function H(){return e?e.type||"crypto-node":"undefined"}r=r&&r.hasOwnProperty("default")?r.default:r,e=e&&e.hasOwnProperty("default")?e.default:e;var R="object"==typeof window&&(window.crypto||window.msCrypto),O=R&&(R.subtle||R.webkitSubtle||R.Subtle),U='Unsupported algorithm name specified! Supported algorithms: "HS256", "HS384", "HS512", "RS256", "RS384", "RS512" and "none".',x="Illegal argument specified!",L=function(){function t(t){if("string"!=typeof t)throw new Error(x);var r=t.split(".");if(3!==r.length)throw new Error(x);var e=r[0],n=r[1],i=r[2];this.header=e,this.payload=n,this.signature=i}return t.prototype.toString=function(){return this.header+"."+this.payload+"."+this.signature},t}(),G=function(){function t(t){if(this.header={},this.payload={},this.signature="","string"!=typeof t)throw new Error(x);var r=h(t);r&&(this.header=r.header?o(c(r.header)):{},this.payload=r.payload?o(f(this.header)?g(r.payload):c(r.payload)):{},this.signature=r.signature||"")}return t.prototype.toString=function(){return w(JSON.stringify(this.header))+"."+(f(this.header)?d(JSON.stringify(this.payload)):w(JSON.stringify(this.payload)))+"."+this.signature},t}();t.webCrypto=R,t.webCryptoSubtle=O,t.UNSUPPORTED_ALGORITHM=U,t.ILLEGAL_ARGUMENT=x,t.JwtSplit=L,t.JwtDecode=G,t.s2J=o,t.b2s=u,t.b2bu=a,t.bu2b=s,t.bu2s=c,t.isGzip=f,t.jwtDecode=l,t.jwtSplit=h,t.s2b=p,t.s2bu=w,t.s2zbu=d,t.unzip=y,t.zbu2s=g,t.zip=b,t.createHmac=S,t.algHSsign=m,t.algHSverify=A,t.RS2AB=C,t.algVerify=N,t.algSign=P,t.jwtVerify=I,t.jwtSign=j,t.resignJwt=B,t.cryptoType=H,Object.defineProperty(t,"__esModule",{value:!0})});
